(this["webpackJsonpmap-app"]=this["webpackJsonpmap-app"]||[]).push([[0],{52:function(e,t,n){e.exports=n(83)},79:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),c=n.n(o),s=n(7),l=function(e){return fetch("/user/login",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:""}}}))},u=function(e){return fetch("/user/register",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},i=function(){return fetch("/user/logout").then((function(e){return e.json()})).then((function(e){return e}))},m=function(){return fetch("/user/authenticated").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:""}}}))},p=Object(a.createContext)(),d=function(e){var t=e.children,n=Object(a.useState)(null),o=Object(s.a)(n,2),c=o[0],l=o[1],u=Object(a.useState)(!1),i=Object(s.a)(u,2),d=i[0],f=i[1],b=Object(a.useState)(!1),h=Object(s.a)(b,2),g=h[0],E=h[1];return Object(a.useEffect)((function(){m().then((function(e){l(e.user),f(e.isAuthenticated),E(!0)}))}),[]),r.a.createElement("div",null,g?r.a.createElement(p.Provider,{value:{user:c,setUser:l,isAuthenticated:d,setIsAuthenticated:f}},t):r.a.createElement("h1",null,"Loading"))},f=n(85),b=n(86),h=function(e){var t=Object(a.useContext)(p),n=t.isAuthenticated,o=(t.user,t.setIsAuthenticated),c=t.setUser,s=function(){i().then((function(e){e.success&&(c(e.user),o(!1))}))};return r.a.createElement(b.a,{bg:"light",expand:"lg"},r.a.createElement(b.a.Brand,{href:"#home"},"Mapp-App"),r.a.createElement(b.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(b.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(f.a,{className:"mr-auto"},n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a.Link,{href:"/"},r.a.createElement("li",{className:"nav-item nav-link"},"Home")),r.a.createElement(f.a.Link,{href:"/todos"},r.a.createElement("li",{className:"nav-item nav-link"},"To-dos")),r.a.createElement(f.a.Link,{href:"/map"},r.a.createElement("li",{className:"nav-item nav-link"},"Map")),r.a.createElement("button",{type:"button",className:"btn btn-link nav-item nav-link",onClick:s},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a.Link,{href:"/"},r.a.createElement("li",{className:"nav-item nav-link"},"Home")),r.a.createElement(f.a.Link,{href:"/login"},r.a.createElement("li",{className:"nav-item nav-link"},"Login")),r.a.createElement(f.a.Link,{href:"/register"},r.a.createElement("li",{className:"nav-item nav-link"},"Register"))))))},g=function(){return r.a.createElement("h1",null,"Home Page")},E=n(16),v=n(20),j=n(87),O=function(e){return e.message.msgError?r.a.createElement(j.a,{variant:"danger"},e.message.msgBody):r.a.createElement(j.a,{variant:"primary"},e.message.msgBody)},y=function(e){var t=Object(a.useState)({username:"",password:""}),n=Object(s.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)(null),i=Object(s.a)(u,2),m=i[0],d=i[1],f=Object(a.useContext)(p),b=function(e){c(Object(v.a)(Object(v.a)({},o),{},Object(E.a)({},e.target.name,e.target.value))),console.log(o)};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),l(o).then((function(t){var n=t.isAuthenticated,a=t.user,r=t.message;n?(f.setUser(a),f.setIsAuthenticated(n),e.history.push("/todos")):d(r)}))}},r.a.createElement("h3",null,"Please Sign in"),r.a.createElement("label",{htmlFor:"username",className:"sr-only"},"Username"),r.a.createElement("input",{type:"text",name:"username",onChange:b,className:"form-control",placeholder:"Enter Username"}),r.a.createElement("label",{htmlFor:"password",className:"sr-only"},"Username"),r.a.createElement("input",{type:"password",name:"password",onChange:b,className:"form-control",placeholder:"Enter Password"}),r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Log in")),m?r.a.createElement(O,{message:m}):null)},N=function(e){var t=Object(a.useState)({username:"",password:""}),n=Object(s.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)(null),i=Object(s.a)(l,2),m=i[0],p=i[1],d=Object(a.useRef)(null);Object(a.useEffect)((function(){return function(){clearTimeout(d)}}),[]);var f=function(e){c(Object(v.a)(Object(v.a)({},o),{},Object(E.a)({},e.target.name,e.target.value))),console.log(o)},b=function(){c({username:"",password:""})};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),u(o).then((function(t){var n=t.message;p(n),b(),n.msgError||(d=setTimeout((function(){e.history.push("/login")}),2e3))}))}},r.a.createElement("h3",{className:"m-2"},"Register to Start Exploring"),r.a.createElement("label",{htmlFor:"username",className:"sr-only"},"Username"),r.a.createElement("input",{type:"text",name:"username",value:o.username,onChange:f,className:"form-control m-2",placeholder:"Enter Username"}),r.a.createElement("label",{htmlFor:"password",className:"sr-only"},"Username"),r.a.createElement("input",{type:"password",name:"password",value:o.password,onChange:f,className:"form-control m-2",placeholder:"Enter Password"}),r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block m-2",type:"submit"},"Register")),m?r.a.createElement(O,{message:m}):null)},w=function(e){return r.a.createElement("li",null,e.todo.name)},k=function(){return fetch("user/todos").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorised"},msgError:!0}}))},x=function(e){return fetch("user/todo",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorised"},msgError:!0}}))},S=function(e){var t=Object(a.useState)({name:""}),n=Object(s.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)([]),u=Object(s.a)(l,2),i=u[0],m=u[1],d=Object(a.useState)(null),f=Object(s.a)(d,2),b=f[0],h=f[1],g=Object(a.useContext)(p);Object(a.useEffect)((function(){k().then((function(e){m(e.todos)}))}),[]);var E=function(){c({name:""})};return r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group"},i.map((function(e){return r.a.createElement(w,{key:e._id,todo:e})}))),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),x(o).then((function(e){var t=e.message;E(),t.msgError?"UnAuthorised"===t.msgBody?(h(t),g.setUser({username:""}),g.setIsAuthenticated(!1)):h(t):k().then((function(e){m(e.todos),h(t)}))}))}},r.a.createElement("label",{htmlFor:"todo"},"Enter todo"),r.a.createElement("input",{type:"text",name:"todo",value:o.name,onChange:function(e){c({name:e.target.value})},className:"form-control",placeholder:"Please Enter Todo"}),r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Submit")),b?r.a.createElement(O,{message:b}):null)},L=n(30),C=n.n(L),A=n(48),U=(n(79),function(){var e=Object(a.useState)({Location:""}),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useCallback)((function(e){if("save-fav"===e.action.id){var t=u.current.popup.selectedFeature.attributes.Location;console.log(t),C.a.post("user/favourite",t).then((function(e){o(e.config)}))}}));console.log(n.data);var l=Object(a.useRef)(),u=Object(a.useRef)();return Object(a.useEffect)((function(){Object(A.loadModules)(["esri/Map","esri/views/MapView","esri/widgets/Locate","esri/Graphic","esri/layers/GraphicsLayer"],{css:!0}).then((function(e){var t=Object(s.a)(e,5),n=t[0],a=t[1],r=t[2],o=t[3],i=t[4],m=new n({basemap:"topo-vector"}),p=new a({container:l.current,map:m,center:[138,-34],zoom:6});u.current=p;var d=new r({view:p,graphic:new o({symbol:{type:"simple-marker"}})}),f=document.createElement("div");function b(e){var t="Lat/Lon "+e.latitude.toFixed(3)+" "+e.longitude.toFixed(3)+" | Scale 1:"+Math.round(1*p.scale)/1+" | Zoom "+p.zoom;f.innerHTML=t}f.id="coordsWidget",f.className="esri-widget esri-component",f.style.padding="7px 15px 5px",p.ui.add(f,"bottom-right"),p.watch("stationary",(function(e){b(p.center)})),p.on("pointer-move",(function(e){b(p.toMap({x:e.x,y:e.y}))})),p.ui.add(d,"top-right"),p.ui.add(f,"bottom-right");var h=new i;m.add(h);var g={type:"simple-marker",color:[226,119,40],outline:{color:[255,255,255],width:1}};return p.popup.actions.push({title:"Save",id:"save-fav",className:"esri-icon-grant"}),p.popup.on("trigger-action",c),C.a.get("/user/dots").then((function(e){for(var t=e.data,n=0;n<t.length;n++){var a={title:t[n].Name,content:t[n].Location},r=new o({geometry:t[n].point,symbol:g,attributes:t[n],popupTemplate:a});h.add(r)}})),function(){p&&(p.container=null)}}))}),[]),r.a.createElement("div",null,r.a.createElement("div",{className:"webmap",ref:l}),r.a.createElement("div",null,n.data))}),F=n(50),T=n(4),M=function(e){e.component;var t=Object(F.a)(e,["component"]),n=Object(a.useContext)(p),o=n.isAuthenticated;n.user;return r.a.createElement(T.b,Object.assign({},t,{render:function(e){if(!o)return r.a.createElement(T.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},B=n(29);var P=function(){return r.a.createElement(B.a,null,r.a.createElement(h,null),r.a.createElement(T.b,{exact:!0,path:"/",component:g}),r.a.createElement(T.b,{exact:!0,path:"/login",component:y}),r.a.createElement(T.b,{exact:!0,path:"/register",component:N}),r.a.createElement(M,{path:"/todos",component:S}),r.a.createElement(T.b,{exact:!0,path:"/todos",component:S}),r.a.createElement(T.b,{exact:!0,path:"/map",component:U}))};c.a.render(r.a.createElement(d,null," ",r.a.createElement(P,null)," "),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.8ae48138.chunk.js.map